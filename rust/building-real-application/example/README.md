# 수동 메모리 관리

## 스택

스택은 각각의 함수에 의해 생성된 변수들을 저장하는 프로세스 메모리 영역

1. 스택 프레임 : 각 함수의 메모리 정보. 여기에 지역 변수들이 저장되고 모든 함수 호출에 대한 새로운 스택 프레임이 현재 프레임 위에 할당. 스택프레임을 생성한 함수만 스택 프레임에 접근할 수 있다. 그리고 그것이 함수의 범위를 지정한다.
2. 스택에 있는 모든 변수들의 크기는 컴파일시에 알려져야 한다.
3. 스택은 제한된 크기를 갖는다. 스택의 크기는 머신 아키텍처, 운영체제, 컴파일러 그리고 다른 요소들에 의해 결정된다. 예를 들어 무한 재귀에 의해 스택의 끝에 도달하게 되면, 프로그램은 스택 오버플로우에 의해 충돌이 발생한다.

## 힙

힙은 자동으로 관리되지 않는 프로세스 메모리 영역이며 수동으로 메모리를 할당해야 한다. 중요한 것은 사용이 끝나면 그 메모리를 수동으로 해제해야 한다. 할당된 힙 메모리 해제에 실패하면 메모리 누수로 이어질 수 있다.

1. 힙은 사이즈 제한이 없다. 시스템의 물리적인 크기에만 제한을 받는다.
2. 프로그램의 모든 위치에서, 모든 함수에 의해 힙에 접근할 수 있다.
3. 힙에 할당하는 것은 과도한 비용을 초래할 수 있기 때문에 가능하면 힙에 할당하는 것은 피하는 것이 좋다. 만약에 프로그램이 힙에 수많은 블럭을 할당하고 해제를 반복하면 힙이 조각나 버린다. 그렇게 되면 새로운 위치에 필요한 공간을 효율적으로 찾는 것이 훨씬 더 어려워진다.

## 스마트 포인터

시스템 언어인 rust는 고수준 언어에서 제공하는 가비지 콜렉터가 없기 때문에 스마트 포인터를 사용한다. 스마트 포인터는 추가적인 기능을 제공하는 원시 포인터(raw pointer)를 감싸는 wrapper이다.

스마트 포인터에는 여러 타입이 있지만, 가장 일반적인 것은 포인터가 범위를 벗어났을 때 그것이 가리키는 메모리를 해제해하도록 하는 것이다.
